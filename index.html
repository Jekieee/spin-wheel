<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>幸运转盘</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    height: 100vh;
    overflow: hidden;

    /* 超高清背景图 */
    background: url('https://images.unsplash.com/photo-1517818332936-6cfdd8ac3be1?auto=format&fit=crop&w=1500&q=80') no-repeat center/cover;
  }

  /* 半透明模糊遮罩层，让内容更突出 */
  .overlay {
    backdrop-filter: blur(18px);
    background: rgba(255, 255, 255, 0.28);
    width: 100%;
    height: 100%;
    position: absolute;
    inset: 0;
  }

  .content {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
    padding-top: 40px;
  }

  h1 {
    margin: 0;
    font-size: 36px;
    color: #fff;
    letter-spacing: 1px;
    text-shadow: 0px 3px 8px rgba(0,0,0,0.5);
  }

  #wheel-container {
    position: relative;
    width: 360px;
    height: 360px;
    margin-top: 30px;
    filter: drop-shadow(0 12px 24px rgba(0,0,0,0.35));
  }

  #wheel {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 10px solid rgba(255,255,255,0.9);
    box-shadow:
      0 0 20px rgba(255,255,255,0.6),
      0 0 40px rgba(255,255,255,0.4),
      inset 0 0 30px rgba(255,255,255,0.4);
    background: #ffffff;
  }

  #pointer {
    position: absolute;
    top: -28px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;

    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-bottom: 38px solid #ff4d4f;

    filter: drop-shadow(0 4px 10px rgba(0,0,0,0.5));
  }

  button {
    margin-top: 20px;
    padding: 14px 32px;
    font-size: 18px;
    border-radius: 60px;
    border: none;
    cursor: pointer;
    color: white;

    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    box-shadow: 0 6px 14px rgba(0,0,0,0.25);
    transition: 0.25s ease-out;
  }
  button:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 22px rgba(0,0,0,0.35);
  }
  button:active {
    transform: translateY(0px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.28);
  }
  button:disabled {
    background: #bbb;
    cursor: default;
  }

  #result {
    margin-top: 22px;
    font-size: 26px;
    color: #fff;
    font-weight: bold;
    text-shadow: 0 4px 12px rgba(0,0,0,0.6);
    opacity: 0;
    transition: opacity .4s ease;
  }
</style>
</head>

<body>
<div class="overlay"></div>

<div class="content">

  <h1>✨ 幸运转盘 ✨</h1>

  <div id="wheel-container">
    <canvas id="wheel"></canvas>
    <div id="pointer"></div>
  </div>

  <button id="spin-btn">开始抽取</button>

  <div id="result"></div>
</div>

<script>
  const canvas = document.getElementById("wheel");
  const ctx = canvas.getContext("2d");
  const spinBtn = document.getElementById("spin-btn");
  const resultDiv = document.getElementById("result");

  const size = 360;
  canvas.width = size;
  canvas.height = size;

  const items = [
    "学习 30 分钟",
    "刷手机 10 分钟",
    "喝水走动",
    "写作业",
    "复习讲义",
    "准备简历",
    "做项目",
    "整理房间"
  ];

  let currentAngle = 0;
  let spinning = false;

  const colors = items.map((_, i) => 
    `hsl(${(360 * i) / items.length}, 70%, 60%)`
  );

  function drawWheel() {
    const radius = size / 2;
    const cx = radius;
    const cy = radius;
    const slice = (2 * Math.PI) / items.length;

    ctx.clearRect(0, 0, size, size);

    for (let i = 0; i < items.length; i++) {
      const angle = currentAngle + i * slice;

      ctx.beginPath();
      ctx.moveTo(cx, cy);
      ctx.arc(cx, cy, radius - 5, angle, angle + slice);
      ctx.closePath();
      ctx.fillStyle = colors[i];
      ctx.fill();

      ctx.save();
      ctx.translate(cx, cy);
      ctx.rotate(angle + slice / 2);
      ctx.textAlign = "right";
      ctx.fillStyle = "#fff";
      ctx.font = "18px system-ui";
      ctx.fillText(items[i], radius - 28, 6);
      ctx.restore();
    }

    ctx.beginPath();
    ctx.arc(cx, cy, 40, 0, 2 * Math.PI);
    ctx.fillStyle = "#ffffffcc";
    ctx.fill();
  }

  drawWheel();

  function spin() {
    if (spinning) return;
    spinning = true;
    spinBtn.disabled = true;
    resultDiv.style.opacity = 0;

    const slice = (2 * Math.PI) / items.length;

    const extraTurns = 4 + Math.random() * 3;
    const targetAngle = currentAngle + extraTurns * 2 * Math.PI + Math.random() * 2 * Math.PI;

    const duration = 3500;
    const start = performance.now();
    const startAngle = currentAngle;

    function animate(now) {
      const t = now - start;
      const progress = Math.min(t / duration, 1);
      const easeOut = 1 - Math.pow(1 - progress, 3);

      currentAngle = startAngle + (targetAngle - startAngle) * easeOut;
      drawWheel();

      if (progress < 1) {
        requestAnimationFrame(animate);
      } else {
        spinning = false;
        spinBtn.disabled = false;

        const normalized = (currentAngle % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);

        const pointerAngle = (3 * Math.PI / 2 - normalized + 2 * Math.PI) % (2 * Math.PI);

        const index = Math.floor(pointerAngle / slice);
        const result = items[index];

        resultDiv.textContent = "结果：" + result;
        resultDiv.style.opacity = 1;
      }
    }

    requestAnimationFrame(animate);
  }

  spinBtn.addEventListener("click", spin);
</script>

</body>
</html>
